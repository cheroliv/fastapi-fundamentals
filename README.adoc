= FastAPI fundamentals

== Mise en place de l'environement

== REST API

=== Canary End points
Deux premiers end points: "/" et "/date"

[source,python]
----
from fastapi import FastAPI
from datetime import datetime

app = FastAPI()


@app.get("/")
def welcome():
    """Return a friendly welcome message."""
    return {'message': "Welcome to the Car Sharing service!"}


@app.get("/date")
def date():
    """Return the current date/time."""
    return {'date': datetime.now()}
----


=== Canary Tests

[source,python]
----
from fastapi.testclient import TestClient

from carsharing import app

from datetime import datetime

import json

client = TestClient(app)


def test_welcome():
    response = client.get("/")
    assert response.status_code == 200
    assert "Welcome" in response.text


def test_date():
    response = client.get("/date")
    assert response.status_code == 200
    # assert date is a valid format
    datetime.fromisoformat(json.loads(response.text)["date"])
----


